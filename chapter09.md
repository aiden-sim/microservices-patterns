# 마이크로서비스 테스트 1부
- 수동 테스트 문제점
  - 수동 테스트는 비효율의 극치
  - 테스트가 너무 늦다 

## 9.1 마이크로서비스 아키텍처 테스트 전략

### 9.1.1 테스트 개요
- 테스트 정의
  - 테스트 케이스는 어떤 목표를 달성하기 위해 개발된 테스트 입력, 실행 조건, 기대 결과의 집합 
 
- 테스트 목적은 SUT(System Under Test)의 동작을 확인

#### 자동화 텥스트 작성
- 대부분 JUnit등의 테스트 프레임워크로 작성

- 자동화 테스트는 다음 4단계로 구성
  - 1) 설정(setup) : SUT와 그 디펜던시로 구성된 테스트 픽스처를 초기화
  - 2) 실행(exercise) : SUT를 호출
  - 3) 확인(verify) : 호출 결과 및 SUT 상태를 단언함
  - 4) 정리(teardown) : 필요 시 테스트 픽스처를 깨끗이 정리


#### 목/스텁을 이용한 테스트
- SUT는 대부분 디펜던시를 갖고 있고, 이런 디펜던시 때문에 테스트가 복잡하고 느려짐
  - 해결 방법은 디펜던시를 테스트 더블로 대체

- 테스트 더블은 스텁(stub)과 목(mock) 두 종류
  - 스텁은 SUT에 값을 반환하는 테스트 (then)
  - 목은 SUT가 정호가하게 디펜던시를 호출했는지 확인하는 테스트 (verify)

#### 테스트 종류
- 성능 테스트(performance test), 사용성 테스트(usability test)는 애플리케이션의 서비스 품질 수준을 확인하는 테스트

- 테스트 종류
  - 단위 테스트(unit test) : 서비스의 작은 부분을 테스트
  - 통합 테스트(integration test) : 애플리케이션 서비스가 인프라 서비스 및 타 애플리케이션 서비스와 잘 연동되어 작동하는지 확인
  - 컴포넌트 테스트(component test) : 개별 서비스에 대한 인수 테스트
  - 종단 테스트(end-to-end test) : 전체 애플리케이션에 대한 인수 테스트

#### 테스트 사분면: 테스트 분류 기준
- 두 가지 척도로 테스트를 분류
  - 비즈니스에 관한 테스트인가, 기술에 관한 테스트인가?
    - 비즈니스 관련 테스트는 도메인 전문가의 용어를, 기술에 관한 테스트는 개발자와 구현의 용어를 사용 
  - 테스트를 하는 목적이 프로그래밍을 지원하기 위함인가, 아니면 애플리케이션을 평가하기 위함인가? 
    - 개발자는 프로그래밍 지원 테스트를 일상 업무의 일부로 사용, 애플리케이션 평가 테스트는 개선이 필요한 부분을 식별하는 것이 목표

- 테스트 사분면
  - Q1 : 프로그래밍/기술 관련 지원 - 단위/통합 테스트
  - Q2 : 프로그래밍/비즈니스 관련 지원 - 컴포넌트/종단 간 테스트
  - Q3 : 애플리케이션/비즈니스 관련 평가 - 사용성/예비 테스트
  - Q4 : 애필레키이션/기술 관련 평가 - 비가능(성능 등) 인수 테스트

#### 테스트 피라미드: 테스트 역량을 집중
- 테스트 범위가 늘어나면 실행 시간, 복잡도가 증가하고 신뢰성은 떨어지기 마련

- 테스트 피라미드 (379P)
  - 피라미드 하부는 빠르고 간단하고 미더운 단위 테스트
  - 피라미드 상부는 느리고 복잡하고 취약한 종단 간 테스트
  - 상부로 올라갈 수록 작성하는 테스트 개수는 줄어듬 

### 9.1.2 마이크로서비스 테스트

#### 컨슈머 주도 계약 테스트

#### 서비스 테스트: 스프링 클라우드 컨트랙트

#### 컨슈머 계약 테스트: 메시징 API

### 9.1.3 배포 파이프라인



## 9.2 서비스 단위 테스트 작성


## 9.3 마치며
